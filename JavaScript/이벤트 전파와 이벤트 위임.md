## 이벤트 전파

이벤트가 발생하면 이벤트 객체가 생성되고 이벤트가 발생한 객체가 이벤트 타깃이된다.
**이벤트 객체는 이벤트 타깃을 중심으로 DOM 트리를 통해 전파**되는데 전파되는 방향에 따라 3단계로 구분된다.

1. 캡처링 단계 : 이벤트가 상위 요소에서 하위 요소 방향으로 전파
2. 타깃 단계 : 이벤트가 이벤트 타깃에 도달
3. 버블링 단계 : 이벤트가 하위 요소에서 상위 요소 방향으로 전파

![event](https://user-images.githubusercontent.com/62097867/209516713-4a42c7f7-0b11-4c9e-8eb9-26112209b705.png)

### 이벤트 핸들러 동작 순서

한 요소에 이벤트가 발생하면 이벤트가 하위 요소에서 상위 요소 방향으로 전파되는 특성(버블링)으로 인해
이벤트가 전파되는 경로에 위치한 모든 DOM 요소의 이벤트 핸들러가 차례로 동작한다.

![bubbling](https://user-images.githubusercontent.com/62097867/209519353-39fa0252-ede5-4c97-9b64-8480d61fa3b8.png)

```html
<!-- form > div > p 중첩 구조에서의 핸들러 동작 순서 : p -> div -> form -->
<form onclick="alert('form')">
  FORM
  <div onclick="alert('div')">
    DIV
    <p onclick="alert('p')">P</p>
  </div>
</form>
```

- 기본적으로 이벤트 핸들러는 타깃 단계와 버블링 단계의 이벤트를 캐치한다.

  - 캡처링 단계의 이벤트를 캐치하려면 addEventListener의 catpure 옵션을 true로 설정 `elem.addEventListener(event, handler, true)`
  - 하지만 캡처링 단계의 이벤트를 캐치해야 할 경우는 거의 없다.

- 거의 모든 이벤트는 버블링되지만 버블링 되지 않는 이벤트도 있다. 이들은 이벤트 타깃의 상위 요소에서 이벤트를 캐치하려면 캡처링 단계의 이벤트를 캐치하거나 다른 이벤트로 대체해야 한다.
  - 포커스 이벤트: focus, blur (대체 이벤트: focusin, focusout)
  - 리소스 이벤트: load, unload, abort, error
  - 마우스 이벤트: mouseenter, mouseleave (대체 이벤트: mouseover, mouseout)

### `event.target`과 `event.currentTarget`

`event.target` (타깃 요소)

- 실제 이벤트가 발생한 가장 안쪽의 요소
- 버블링이 진행되어도 변하지 않는다.

`event.currentTarget` (=this)

- '현재' 요소로 현재 실행 중인 핸들러가 할당된 요소

### 버블링 중단하기

이벤트 객체의 `stopPropagation` 메소드는 이벤트 전파를 중지시킨다.

이벤트 전파를 중지시키면 상위 요소에 이벤트를 위임하더라도 상위 요소에서 이벤트를 캐치할 수 없다.
하위 요소의 이벤트를 개별적으로 처리하고자 할 때 사용한다.

## 이벤트 위임

여러 개의 하위 요소에 동일한 이벤트 핸들러를 각각 등록하는 대신
공통 조상 요소에 하나의 이벤트 핸들러만 등록하여 하위 요소의 이벤트를 한꺼번에 핸들링하는 패턴이다.

공통 조상에 할당한 핸들러에서 `event.target`을 이용해 원하는 요소에서 이벤트가 발생했는지 확인한다.
(matches, closest 메서드, dataset 속성 등등 사용)

### 장점

- 하위 요소가 많을 경우에도 하나의 핸들러만 할당하기 때문에 메모리가 절약된다.
- 동적으로 하위 요소를 추가하더라도 일일이 이벤트 핸들러를 등록할 필요가 없기 때문에 코드가 짧아진다.
