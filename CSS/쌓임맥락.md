## 쌓임 맥락과 z-index

💡 **쌓임 맥락(stacking context)** 이란 사용자가 보는 기준으로 가상의 Z축을 생성하여 **HTML 요소들을 3차원으로 보는 것**을 말한다. 하나의 쌓임 맥락은 자신만의 3차원 공간을 형성하며 **z-index를 통해 공간 내의 우선순위를 결정**한다.

- 쌓임 맥락이 다른 쌓임 맥락을 포함할 수 있고 계층 구조를 이룬다.
    - 쌓임 맥락을 만들지 않는 요소는 부모 쌓임 맥락에 의해 동화된다.
- 쌓임 맥락에서 쌓임을 처리할 땐(by z-index) 자손 요소만 고려한다.

## 쌓임 맥락이 형성되는 조건

- 문서의 루트 요소 `<html>`
- position이 absoulte/relative이고, z-index가 auto가 아닌 요소
- position이 fixed/sticky인 요소
- flex/grid 컨테이너의 자식 중 z-index가 auto가 아닌 요소
- opacity가 1보다 작은 요소
- transform 속성이 none이 아닌 요소

## 특정 쌓임 맥락에서 쌓임 순서

`쌓임 순서 (Stacking Order)` - z-index가 높으면 위에, 낮으면 아래로 가는 것

1. 쌓임 맥락의 뿌리(root) 요소.
2. position 값이 있고 `z-index` 값이 `음수`인 요소(와 자식들)
3. position 값이 없는 요소
4. position 값이 있고 `z-index` 값이 `auto`인 요소(와 그 자식들)
5. position 값이 있고 `z-index` 값이 `양수`인 요소(와 그 자식들)

🔥 **동일한 성격의 요소라면 마크업 순서로 쌓인다.**

## 예시

### 1

![Untitled11](https://user-images.githubusercontent.com/62097867/218247302-38e16424-793e-41f1-a143-edc5e5bdda0e.png)

position 속성이 지정되지 않은 요소가 가장 아래에 쌓임

### 2

```html
<div>1</div>
<div>2</div>
<div>3
  <div>4</div>
  <div>5</div>
  <div>6</div>
</div>
```

![Untitled111](https://user-images.githubusercontent.com/62097867/218247310-4369d2c5-8732-4940-9947-447a6b791caa.png)

- div 1, 2, 3은 같은 레벨에 있으므로 z-index에 따라 쌓이므로 `div2 > div3 > div1` 순으로 쌓인다.
- div 4, 5, 6은 div3의 쌓임 맥락안에서 z-index에 따라 쌓이므로 `div5 > div6 > div4` 순으로 쌓인다.
    - div 1, 2와는 다른 쌓임 맥락에 속하므로 div 1, 2의 z-index보다 커도 영향을 주지 않는다.
    - div 4, 5, 6은 통째로 부모 쌓임 맥락(div3)안에 배치된다. (div1 위에 쌓일 수 없음)